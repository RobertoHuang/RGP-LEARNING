 

## 类加载与初始化

```java
public class ConstantTest {
    public static void main(String[] args) {
        System.out.println(Child.pstr);
    }
}

class Parent {
    public static String pstr = "Hello World - Parent";

    static {
        System.out.println("Parent Static Block");
    }
}

class Child extends Parent {
    public static String cstr = "Hello World - Child";

    static {
        System.out.println("Child Static Block");
    }
}
```

执行如上代码输出结果如下

```reStructuredText
Parent Static Block
Hello World - Parent
```

说明`Child`类没有被初始化，那`Child`类会被加载吗。通过`JVM`参数`-XX:+TraceClassLoading`追踪类加载信息

```reStructuredText
...
[Loaded roberto.growth.process.constant.Parent from file:/D:/Workspace/myblog/target/classes/]
[Loaded roberto.growth.process.constant.Child from file:/D:/Workspace/myblog/target/classes/]
...
```

## 常量的本质含义

```java
public class ConstantTest {
    public static void main(String[] args) {
        System.out.println(Child.pstr);
    }
}

class Parent {
    public static final String pstr = "Hello World - Parent";

    static {
        System.out.println("Parent Static Block");
    }
}

class Child extends Parent {
    public static final String cstr = "Hello World - Child";

    static {
        System.out.println("Child Static Block");
    }
}
```

修改`Demo`将上诉的实例变量修改为常量后再运行`main`方法，输出结果如下

```text
Hello World - Parent
```

`final`表示常量 -> 编译阶段这个常量就会被存入到调用这个常量的那个方法所在的类的常量池当中，本质上调用类并没有直接引用到定义常量的类，因此并不会触发定义常量的类的初始化。通过`-XX:+TraceClassLoading`追踪类的加载可以发现`Parent`和`Child`类并未被加载。所以`ConstantTest`与`Parent`及`Child`没有任何关系，甚至可以将`Parent`和`Child`的`class`文件删除

## 常量反编译及助记符

对上诉代码产生的`ConstantTest.class`进行反汇编(`javap -c`)，得到的结果如下

![常量反编译及认识助记符](https://raw.githubusercontent.com/RobertoHuang/RGP-LEARNING/master/%E6%B7%B1%E5%85%A5%E7%90%86%E8%A7%A3JAVA%E8%99%9A%E6%8B%9F%E6%9C%BA/images/%E5%B8%B8%E9%87%8F%E5%8F%8D%E6%B1%87%E7%BC%96%E5%8F%8A%E8%AE%A4%E8%AF%86%E5%8A%A9%E8%AE%B0%E7%AC%A6.png)

常量相关助记符:

> 助记符:`bipush`表示将单字节(`-128~127`)的常量推送至栈顶
>
> 助记符:`sipush`表示将短整型常量值(`-32768~32767`)推送至栈顶
>
> 助记符:`iconst_1`表示将`int`类型`1`推送至栈顶`iconst_1~iconst_5`
>
> 助记符:`ldc`表示将`int、float、string`类型的常量值从常量池中推送至栈顶

## 附录

关于`JVM`参数说明

> `-XX:+<Option>`，表示开启`Option`选项
>
> `-XX:-<Option>`，表示关闭`Option`选项
>
> `-XX:<Option>=<Value>`将`Option`选项的值设置为`Value`