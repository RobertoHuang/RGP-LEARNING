 

#  了解线程



## 并发和并行

在`JAVA`并发编程网中对两个词的解释是

- 并行是指两个或者多个事件在同一时刻发生
- 而并发是指两个或多个事件在同一时间间隔发生

大白话说就是并行是在多核处理器出现之后才成为可能，而单核处理器看似多任务同时执行其实是操作系统来完成多任务间对`CPU`的运行切换，由于切换的速度足够快而让人感觉它是在同时执行的

## 创建线程

  - 继承`Thread`类

    ```java
    public class MyThread extends Thread {
        @Override
        public void run() {
            System.out.println(Thread.currentThread().getName() + ":继承Thread类方式创建线程");
        }
    
        public static void main(String[] args) {
            Thread thread = new MyThread();
            thread.start();
        }
    }
    ```

  - 实现`Runable`接口

    ```java
    public class MyRunnable implements Runnable {
        @Override
        public void run() {
            System.out.println(Thread.currentThread().getName() + ":实现Runnable接口方式创建线程");
        }
    
        public static void main(String[] args) {
            Thread thread = new Thread(new MyRunnable());
            thread.start();
        }
    }
    ```

  以上两种方式都可以创建线程且最终效果相同，不过大部分人更倾向于使用实现`Runnable`接口方式

  - `JAVA`语言为单继承多实现

  - 实现`Runnable`接口是更加符合面向对象思想，线程分为两部分一是线程对象二是线程任务
  - 线程池可以有效的管理实现了`Runnable`接口的线程，如果线程池满了新的线程就会排队等候执行直到线程池空闲出来为止，而如果线程是通过实现`Thread`子类实现的这将会复杂一些

  **注意:在创建线程时最好指定线程的名称，这样在进行线程分析时会给开发人员一些提示**

## 守护线程

如果`JVM`进程中没有一个非守护线程那么`JVM`会退出，也就是说守护线程具备自动结束生命周期的特性

`Deamon`线程主要被用作程序中后台调度以及支持性工作，主线程执行完毕后对应的`Deamon`线程将立即终止，需要注意的是在构建`Deamon`线程时不能依靠`finally`块中的内容来确保执行关闭或清理资源

## 线程生命周期

|   状态名称   |                             说明                             |
| :----------: | :----------------------------------------------------------: |
|     NEW      |         初始状态，线程被构建但是还没调用`start`方法          |
|   RUNNABLE   | 运行状态，`JAVA`线程将操作系统中的就绪和运行两种状态统称运行中 |
|   BLOCKED    |                  阻塞状态，表示线程阻塞于锁                  |
|   WAITING    | 等待状态，进入该状态表示当前线程需要等待其他线程作出一些特定动作(通知/中断) |
| TIME_WAITING | 超时等待状态，该状态不同于`WAITING`，它是可以在指定的时间自行返回 |
|  TERMINATED  |              终止状态，表示当前线程已经执行完毕              |

## 线程StackSize参数

`stack size`越大说明允许的递归深度越多，反之则越少

`stack size`越大则代表创建线程的数量也就越少【`stack size`参数高度依赖平台，即某些平台下该参数无效】

`线程数量=(最大地址空间-JVM堆内存-保留的操作系统内存) / 线程栈大小`，当然线程数量还与操作系统参数配置有关